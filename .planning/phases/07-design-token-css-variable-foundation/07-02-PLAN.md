---
phase: 07-design-token-css-variable-foundation
plan: 02
type: execute
wave: 2
depends_on: ["07-01"]
files_modified:
  - components/modal/modal.vue
  - components/switch/switch.vue
  - components/button/button.vue
  - components/input/input.vue
  - components/select/select.vue
  - components/context-menu/context-menu.vue
  - components/context-menu/context-menu-item.vue
autonomous: true
requirements: [VSTL-01, VSTL-02, COMP-01, COMP-02, COMP-03]

must_haves:
  truths:
    - "Modal overlay uses var(--overlay-bg), not hardcoded rgba(0,0,0,0.4)"
    - "Switch, Select, ContextMenu use var() for all color and spacing values in <style scoped>"
    - "Button and Input heights use var(--size-input-height)"
    - "No bare rgba() or hardcoded #hex values remain in any of the 7 modified component style blocks"
  artifacts:
    - path: "components/modal/modal.vue"
      provides: "Tokenized modal styles — overlay, close-btn, footer"
    - path: "components/switch/switch.vue"
      provides: "Tokenized switch styles — unchecked bg, shadows"
    - path: "components/select/select.vue"
      provides: "Tokenized select — dropdown bg uses --glass-bg-elevated, option hover uses --glass-bg-subtle"
    - path: "components/context-menu/context-menu-item.vue"
      provides: "Tokenized context menu item — icon size uses --size-icon-sm, hover text uses --color-on-primary"
    - path: "components/button/button.vue"
      provides: "Button height uses --size-input-height"
    - path: "components/input/input.vue"
      provides: "Clear-btn dimensions use --size-icon-md"
  key_links:
    - from: "components/modal/modal.vue"
      to: "entrypoints/newtab/styles/variables.css"
      via: "var(--overlay-bg), var(--glass-bg-subtle)"
      pattern: "var\\(--overlay-bg\\)|var\\(--glass-bg-subtle\\)"
    - from: "components/select/select.vue"
      to: "entrypoints/newtab/styles/variables.css"
      via: "var(--glass-bg-elevated) for dropdown"
      pattern: "var\\(--glass-bg-elevated\\)"
    - from: "components/button/button.vue"
      to: "entrypoints/newtab/styles/variables.css"
      via: "var(--size-input-height)"
      pattern: "var\\(--size-input-height\\)"
---

<objective>
Replace all hardcoded rgba colors, hex colors, and pixel spacing in base UI components (Modal, Switch, Button, Input, Select, ContextMenu) with CSS variable references.

Purpose: Base components are reused everywhere — tokenizing them propagates theme consistency across the entire UI.
Output: 7 component files with fully tokenized `<style scoped>` blocks.
</objective>

<execution_context>
@/home/whj/.claude/get-shit-done/workflows/execute-plan.md
@/home/whj/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-design-token-css-variable-foundation/07-01-SUMMARY.md
@entrypoints/newtab/styles/variables.css
@components/modal/modal.vue
@components/switch/switch.vue
@components/button/button.vue
@components/input/input.vue
@components/select/select.vue
@components/context-menu/context-menu.vue
@components/context-menu/context-menu-item.vue
</context>

<tasks>

<task type="auto">
  <name>Task 1: Tokenize Modal, Switch, Button, and Input</name>
  <files>
    components/modal/modal.vue
    components/switch/switch.vue
    components/button/button.vue
    components/input/input.vue
  </files>
  <action>
**modal.vue — 4 replacements in `<style scoped>`:**
1. `.modal-overlay`: `background: rgba(0, 0, 0, 0.4)` → `background: var(--overlay-bg)`
2. `.close-btn`: `padding: 4px` → `padding: var(--spacing-xs)`
3. `.close-btn:hover`: `background: rgba(255, 255, 255, 0.1)` → `background: var(--glass-bg-subtle)`
4. `.modal-footer`: `background: rgba(0, 0, 0, 0.1)` → Define component-local custom property and use it:
   ```css
   .modal-footer {
     --modal-footer-bg: rgba(0, 0, 0, 0.1);
     background: var(--modal-footer-bg);
   }
   ```

**switch.vue — 3 replacements in `<style scoped>`:**
1. `.switch`: `background: rgba(255, 255, 255, 0.1)` → `background: var(--glass-bg-subtle)`
2. `.switch`: `box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1)` → Define and use local property:
   ```css
   .switch {
     --switch-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
     box-shadow: var(--switch-shadow);
   }
   ```
3. `.switch-handle`: `box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2)` → Define and use local property:
   ```css
   .switch-handle {
     --switch-handle-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
     box-shadow: var(--switch-handle-shadow);
   }
   ```

**button.vue — 2 replacements in `<style scoped>`:**
1. `.button`: `height: 40px` → `height: var(--size-input-height)`
2. `.is-square`: `width: 40px` → `width: var(--size-input-height)`

**input.vue — 1 replacement in `<style scoped>`:**
1. `.clear-btn`: `width: 20px` and `height: 20px` → `width: var(--size-icon-md)` and `height: var(--size-icon-md)`

**Important:** Do NOT change any template or script code. Only modify `<style scoped>` blocks. Preserve exact whitespace/formatting conventions.
  </action>
  <verify>
Grep each modified file for bare `rgba(` and hardcoded pixel values in style blocks. Specifically:
- `grep 'rgba(' components/modal/modal.vue` should only find values inside `var()` definitions (local custom properties)
- `grep 'rgba(' components/switch/switch.vue` should only find values inside `var()` definitions
- `grep ': 40px' components/button/button.vue` should return 0 matches
- `grep '20px' components/input/input.vue` should return 0 matches in the clear-btn rule
Run `npx vue-tsc --noEmit` to confirm no type errors.
  </verify>
  <done>
modal.vue uses var(--overlay-bg), var(--glass-bg-subtle), var(--spacing-xs), and local --modal-footer-bg. switch.vue uses var(--glass-bg-subtle) and local shadow properties. button.vue and input.vue use size tokens. No bare rgba() or hardcoded 40px/20px values remain in style blocks.
  </done>
</task>

<task type="auto">
  <name>Task 2: Tokenize Select, ContextMenu, and ContextMenuItem</name>
  <files>
    components/select/select.vue
    components/context-menu/context-menu.vue
    components/context-menu/context-menu-item.vue
  </files>
  <action>
**select.vue — 4 replacements in `<style scoped>`:**
1. `.select-trigger`: `height: 40px` → `height: var(--size-input-height)`
2. `.options-dropdown`: `background: rgba(30, 30, 30, 0.95)` → `background: var(--glass-bg-elevated)` (exact same value as the existing token)
3. `.options-dropdown::-webkit-scrollbar-thumb`: `background: rgba(255, 255, 255, 0.2)` → Define and use local property:
   ```css
   .options-dropdown {
     --select-scrollbar-thumb: rgba(255, 255, 255, 0.2);
   }
   .options-dropdown::-webkit-scrollbar-thumb {
     background: var(--select-scrollbar-thumb);
   }
   ```
4. `.option-item:hover:not(.disabled)`: `background: rgba(255, 255, 255, 0.1)` → `background: var(--glass-bg-subtle)`

**context-menu.vue — 1 replacement in `<style scoped>`:**
1. `.context-menu-content`: `padding: 4px` → `padding: var(--spacing-xs)`

**context-menu-item.vue — 4 replacements in `<style scoped>`:**
1. `.item-content:hover`: `color: #ffffff` → `color: var(--color-on-primary)`
2. `.icon`: `width: 16px; height: 16px` → `width: var(--size-icon-sm); height: var(--size-icon-sm)`
3. `.submenu`: `margin-left: 4px` → `margin-left: var(--spacing-xs)`
4. `.submenu`: `padding: 4px` → `padding: var(--spacing-xs)`

**Important:** min-width values (180px, 160px, 120px) stay as-is per user decision — widths are not tokenized. Do NOT change template or script code.
  </action>
  <verify>
Grep each modified file for bare `rgba(` and hardcoded hex colors in style blocks:
- `grep 'rgba(30' components/select/select.vue` should return 0 matches
- `grep '#ffffff' components/context-menu/context-menu-item.vue` should return 0 matches
- `grep ': 4px' components/context-menu/context-menu.vue` should return 0 matches in the content rule
- `grep ': 16px' components/context-menu/context-menu-item.vue` should only find var() references
Run `npx vue-tsc --noEmit` to confirm no type errors.
  </verify>
  <done>
select.vue dropdown uses var(--glass-bg-elevated), option hover uses var(--glass-bg-subtle), trigger uses var(--size-input-height). context-menu.vue padding uses var(--spacing-xs). context-menu-item.vue hover text uses var(--color-on-primary), icon uses var(--size-icon-sm), submenu padding uses var(--spacing-xs). No bare rgba()/hex in style blocks (except inside local custom property definitions).
  </done>
</task>

</tasks>

<verification>
1. Across all 7 files: `grep -l 'rgba(' components/{modal,switch,button,input,select}/**.vue components/context-menu/*.vue` — any remaining rgba() should ONLY be inside CSS custom property definitions (e.g., `--modal-footer-bg: rgba(...)`)
2. `grep '#ffffff' components/context-menu/context-menu-item.vue` returns 0 matches
3. `npx vue-tsc --noEmit` passes
</verification>

<success_criteria>
- All 7 base components use CSS variable references for colors, spacing, and sizes
- No bare rgba()/hex color values in any component <style scoped> block (only inside local custom property definitions)
- Hardcoded 40px heights replaced with --size-input-height
- All changes are style-only — no template or script changes
</success_criteria>

<output>
After completion, create `.planning/phases/07-design-token-css-variable-foundation/07-02-SUMMARY.md`
</output>
