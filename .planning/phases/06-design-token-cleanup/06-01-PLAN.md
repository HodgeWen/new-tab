---
phase: 06-design-token-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - entrypoints/newtab/styles/variables.css
  - components/input/input.vue
  - components/context-menu/context-menu.vue
  - components/context-menu/context-menu-item.vue
autonomous: false

must_haves:
  truths:
    - "input.vue no longer uses hardcoded rgba tokens"
    - "context-menu.vue no longer uses hardcoded rgba tokens"
    - "Components render correctly across theme variants (default, dark-wallpaper, light-wallpaper)"
  artifacts:
    - path: "entrypoints/newtab/styles/variables.css"
      provides: "Design tokens --glass-bg-disabled, --glass-bg-elevated in all 3 theme blocks"
      contains: "--glass-bg-disabled"
    - path: "components/input/input.vue"
      provides: "Input uses var(--glass-bg-disabled), var(--glass-bg-hover)"
    - path: "components/context-menu/context-menu.vue"
      provides: "Context menu uses var(--glass-bg-elevated)"
  key_links:
    - from: "components/input/input.vue"
      to: "variables.css"
      via: "var(--glass-bg-disabled), var(--glass-bg-hover)"
      pattern: "var\\(--glass-bg-(disabled|hover)\\)"
    - from: "components/context-menu/context-menu.vue"
      to: "variables.css"
      via: "var(--glass-bg-elevated)"
      pattern: "var\\(--glass-bg-elevated\\)"
---

<objective>
Remove remaining hardcoded rgba values in input.vue and context-menu.vue (and context-menu-item.vue) by introducing design tokens and replacing inline rgba. Follows Phase 4 pattern (setting-modal cleanup).

Purpose: Design-system consistency; single source of truth for theme-aware colors.
Output: Updated variables.css with new tokens; input, context-menu, context-menu-item using var() references.
</objective>

<execution_context>
@/home/whj/.claude/get-shit-done/workflows/execute-plan.md
@/home/whj/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-design-token-cleanup/06-RESEARCH.md
@entrypoints/newtab/styles/variables.css
@components/input/input.vue
@components/context-menu/context-menu.vue
@components/context-menu/context-menu-item.vue
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add design tokens to variables.css</name>
  <files>entrypoints/newtab/styles/variables.css</files>
  <action>
Add two new tokens to variables.css in all three theme blocks:

1. **--glass-bg-disabled**: For disabled input background
   - :root: rgba(0, 0, 0, 0.05)
   - [data-theme="dark-wallpaper"]: rgba(0, 0, 0, 0.15)
   - [data-theme="light-wallpaper"]: rgba(0, 0, 0, 0.06)

2. **--glass-bg-elevated**: For context menu / dropdown elevated surfaces
   - :root: rgba(30, 30, 30, 0.95)
   - [data-theme="dark-wallpaper"]: rgba(20, 20, 20, 0.98)
   - [data-theme="light-wallpaper"]: rgba(255, 255, 255, 0.98)

Place them in the glass effect section (near --glass-bg, --glass-bg-hover). Follow existing token ordering and comment style.
  </action>
  <verify>grep -E '--glass-bg-disabled|--glass-bg-elevated' entrypoints/newtab/styles/variables.css | wc -l returns 6 (2 tokens × 3 theme blocks)</verify>
  <done>variables.css defines --glass-bg-disabled and --glass-bg-elevated in :root, dark-wallpaper, and light-wallpaper blocks</done>
</task>

<task type="auto">
  <name>Task 2: Replace hardcoded rgba in input and context-menu components</name>
  <files>components/input/input.vue, components/context-menu/context-menu.vue, components/context-menu/context-menu-item.vue</files>
  <action>
Replace hardcoded rgba with CSS variables:

**input.vue:**
- Line ~131: `.input-wrapper.disabled` — change `background: rgba(0, 0, 0, 0.05)` to `background: var(--glass-bg-disabled)`
- Line ~189: `.clear-btn:hover` — change `background: rgba(255, 255, 255, 0.1)` to `background: var(--glass-bg-hover)` (reuse existing token per RESEARCH)

**context-menu.vue:**
- Line ~115: `.context-menu-content` — change `background: rgba(30, 30, 30, 0.95)` to `background: var(--glass-bg-elevated)`

**context-menu-item.vue:**
- Line ~114: Submenu background — change `background: rgba(30, 30, 30, 0.95)` to `background: var(--glass-bg-elevated)` (same token, no extra work)
  </action>
  <verify>rg 'rgba\(' components/input/input.vue components/context-menu/context-menu.vue components/context-menu/context-menu-item.vue produces no output (0 matches); pnpm build succeeds</verify>
  <done>All three component files use var() instead of hardcoded rgba; pnpm build succeeds</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Visual verification across themes</name>
  <files>components/input/input.vue, components/context-menu/context-menu.vue</files>
  <action>Human performs visual verification per how-to-verify below.</action>
  <what-built>Design token cleanup in input, context-menu, context-menu-item; new tokens in variables.css</what-built>
  <how-to-verify>
1. Run `pnpm dev:web` and open the new tab page.
2. Default theme: Focus search input, disable it (if possible), hover clear button; right-click a site to open context menu. Verify input disabled state, clear-btn hover, and context menu look correct.
3. Switch to dark-wallpaper theme (settings or dev tools data-theme). Repeat checks. Verify elevated surfaces (context menu) adapt.
4. Switch to light-wallpaper theme. Repeat checks. Verify disabled input and context menu read well on light background.
5. Confirm no visual regressions; elements should match previous appearance within theme.
  </how-to-verify>
  <verify>Human confirms no visual regressions across default, dark-wallpaper, light-wallpaper</verify>
  <done>Human approved; components render correctly in all three theme variants</done>
  <resume-signal>Type "approved" or describe issues</resume-signal>
</task>

</tasks>

<verification>
- grep for rgba( in input.vue, context-menu.vue, context-menu-item.vue → 0 matches
- variables.css contains --glass-bg-disabled and --glass-bg-elevated in all 3 theme blocks
- pnpm build succeeds
- Human confirms visual correctness across default, dark-wallpaper, light-wallpaper
</verification>

<success_criteria>
1. input.vue uses var(--glass-bg-disabled) and var(--glass-bg-hover)—no hardcoded rgba
2. context-menu.vue and context-menu-item.vue use var(--glass-bg-elevated)—no hardcoded rgba
3. Components render correctly across all three theme variants
</success_criteria>

<output>
After completion, create `.planning/phases/06-design-token-cleanup/06-01-SUMMARY.md`
</output>
